<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover">
    <title>Lịch Vạn Niên 2026 - Lịch Âm Dương | Xem Ngày Tốt Xấu</title>
    <meta name="description" content="Lịch vạn niên 2026 - Xem lịch âm dương đầy đủ, tra cứu ngày tốt xấu, giờ hoàng đạo, ngày đẹp để làm các việc quan trọng. Lịch vạn niên Việt Nam chính xác nhất.">
    <meta name="keywords" content="lịch vạn niên, lịch âm dương, lịch vạn niên 2026, xem ngày tốt, ngày đẹp, giờ hoàng đạo, lịch âm dương 2026">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://saptet.vn/lich-van-nien.html">
    <meta property="og:title" content="Lịch Vạn Niên 2026 - Lịch Âm Dương | Xem Ngày Tốt Xấu">
    <meta property="og:description" content="Lịch vạn niên 2026 - Xem lịch âm dương đầy đủ, tra cứu ngày tốt xấu, giờ hoàng đạo, ngày đẹp để làm các việc quan trọng.">
    <meta property="og:image" content="https://saptet.vn/assets/images/img_sharing.png">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://saptet.vn/lich-van-nien.html">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;600;700&family=Nunito:wght@300;400;600;700;800&family=Lobster&family=Pacifico&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/colors.css">
    
    <!-- Favicon -->
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.png" type="image/png">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3395045728500314" crossorigin="anonymous"></script>
    
    <!-- Schema Markup -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Lịch Vạn Niên 2026 - Lịch Âm Dương",
        "description": "Lịch vạn niên 2026 - Xem lịch âm dương đầy đủ, tra cứu ngày tốt xấu, giờ hoàng đạo, ngày đẹp để làm các việc quan trọng",
        "url": "https://saptet.vn/lich-van-nien.html",
        "inLanguage": "vi",
        "isPartOf": {
            "@type": "WebSite",
            "name": "Sắp Tết",
            "url": "https://saptet.vn"
        },
        "about": {
            "@type": "Thing",
            "name": "Lịch Vạn Niên",
            "description": "Lịch âm dương Việt Nam"
        }
    }
    </script>
    
    <style>
        /* Performance optimizations */
        * {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Disable animations for users who prefer reduced motion */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        .calendar-hero {
            background: linear-gradient(135deg, #DC143C 0%, #FF4500 25%, #FFD700 50%, #FF6347 75%, #DC143C 100%);
            background-size: 200% 200%;
            padding: clamp(4rem, 10vw, 6rem) clamp(1rem, 4vw, 2rem) clamp(2.5rem, 6vw, 4rem);
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        @media (min-width: 769px) and (prefers-reduced-motion: no-preference) {
            .calendar-hero {
                animation: gradientShift 12s ease infinite;
            }
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .calendar-hero h1 {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 800;
            margin-bottom: 1rem;
            color: #FFD700 !important;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.5), 0 0 30px rgba(255, 215, 0, 0.8);
            line-height: 1.2;
        }
        
        .calendar-hero .subtitle {
            font-size: clamp(1rem, 2vw, 1.3rem);
            margin-bottom: 2rem;
            color: #FFFFFF !important;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.6);
            font-weight: 700;
            line-height: 1.5;
        }
        
        .calendar-content {
            padding: 2rem 0;
        }
        
        .calendar-wrapper {
            display: block;
        }
        
        .calendar-container {
            background: #FFFFFF;
            border-radius: 16px;
            padding: clamp(0.75rem, 2vw, 1.5rem);
            box-shadow: 0 8px 32px rgba(0,0,0,0.08);
            border: 1px solid rgba(220, 20, 60, 0.1);
        }
        
        /* Dialog/Modal Styles */
        .dialog-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            animation: fadeIn 0.2s ease;
        }
        
        .dialog-overlay.active {
            display: flex;
        }
        
        .dialog {
            background: #FFFFFF;
            border-radius: 16px;
            padding: 0;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            border: 1px solid rgba(220, 20, 60, 0.1);
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            animation: slideUp 0.3s ease;
        }
        
        .dialog-header {
            padding: 1.5rem;
            border-bottom: 1px solid #E2E8F0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, #DC143C, #FF4500);
            color: white;
        }
        
        .dialog-header h3 {
            margin: 0;
            font-size: 1.25rem;
            font-weight: 700;
        }
        
        .dialog-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            transition: all 0.2s ease;
            padding: 0;
        }
        
        .dialog-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }
        
        .dialog-close:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.5);
        }
        
        .dialog-content {
            padding: clamp(1rem, 3vw, 1.5rem);
            overflow-y: auto;
            flex: 1;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        @keyframes slideUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .calendar-header {
            margin-bottom: 1.5rem;
        }
        
        .calendar-title-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .calendar-title {
            font-size: clamp(1.5rem, 3vw, 2rem);
            color: #DC143C;
            font-weight: 700;
            line-height: 1.2;
            margin: 0;
            flex: 1;
            min-width: 200px;
        }
        
        .calendar-nav-buttons {
            display: none;
        }
        
        .calendars-container.double .calendar-nav-buttons,
        .calendars-container.triple .calendar-nav-buttons {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .calendar-nav-buttons button {
            background: linear-gradient(135deg, #DC143C, #FF4500);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.2);
            padding: 0.625rem 1.25rem;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 700;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 3px 10px rgba(220, 20, 60, 0.3),
                0 1px 3px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            min-width: 120px;
            position: relative;
            overflow: hidden;
        }
        
        .calendar-nav-buttons button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }
        
        .calendar-nav-buttons button:hover:not(:disabled)::before {
            left: 100%;
        }
        
        .calendar-nav-buttons button:hover:not(:disabled) {
            background: linear-gradient(135deg, #FF4500, #FFD700);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-3px) scale(1.02);
            box-shadow: 
                0 6px 20px rgba(220, 20, 60, 0.4),
                0 2px 6px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }
        
        .calendar-nav-buttons button:active:not(:disabled) {
            transform: translateY(-1px) scale(1.01);
            box-shadow: 
                0 3px 12px rgba(220, 20, 60, 0.35),
                0 1px 3px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }
        
        .calendar-nav-buttons button:focus {
            outline: none;
            box-shadow: 
                0 0 0 4px rgba(220, 20, 60, 0.25),
                0 3px 10px rgba(220, 20, 60, 0.3),
                0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .calendar-nav-buttons button:focus:not(:hover) {
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        .calendar-nav-buttons button:disabled {
            background: linear-gradient(135deg, #E2E8F0, #CBD5E1);
            color: #94A3B8;
            border-color: rgba(148, 163, 184, 0.3);
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            opacity: 0.6;
        }
        
        .calendar-nav-buttons button:disabled::before {
            display: none;
        }
        
        @media (prefers-reduced-motion: reduce) {
            .calendar-nav-buttons button {
                transition: background-color 0.2s ease, border-color 0.2s ease;
            }
            
            .calendar-nav-buttons button:hover:not(:disabled) {
                transform: none;
            }
            
            .calendar-nav-buttons button::before {
                display: none;
            }
        }
        
        
        .calendar-controls-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .go-to-today-btn {
            background: linear-gradient(135deg, #DC143C, #FF4500);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.2);
            padding: 0.625rem 1.25rem;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 700;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 3px 10px rgba(220, 20, 60, 0.3),
                0 1px 3px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .go-to-today-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }
        
        .go-to-today-btn:hover::before {
            left: 100%;
        }
        
        .go-to-today-btn:hover {
            background: linear-gradient(135deg, #FF4500, #FFD700);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-3px) scale(1.02);
            box-shadow: 
                0 6px 20px rgba(220, 20, 60, 0.4),
                0 2px 6px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }
        
        .go-to-today-btn:active {
            transform: translateY(-1px) scale(1.01);
            box-shadow: 
                0 3px 12px rgba(220, 20, 60, 0.35),
                0 1px 3px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }
        
        .go-to-today-btn:focus {
            outline: none;
            box-shadow: 
                0 0 0 4px rgba(220, 20, 60, 0.25),
                0 3px 10px rgba(220, 20, 60, 0.3),
                0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        @media (max-width: 768px) {
            .go-to-today-btn {
                padding: 0.5rem 1rem;
                font-size: 0.85rem;
            }
        }
        
        .year-selector {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .year-selector label {
            font-weight: 600;
            color: #475569;
            font-size: 0.95rem;
        }
        
        .year-selector select {
            padding: 0.5rem 0.875rem;
            border-radius: 8px;
            border: 1.5px solid #E2E8F0;
            font-size: 0.95rem;
            font-weight: 600;
            background: white;
            color: #0F172A;
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 100px;
        }
        
        .year-selector select:hover {
            border-color: #DC143C;
        }
        
        .year-selector select:focus {
            outline: none;
            border-color: #DC143C;
            box-shadow: 0 0 0 3px rgba(220, 20, 60, 0.1);
        }
        
        .view-mode-chips {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .view-mode-chips label {
            font-weight: 600;
            color: #475569;
            font-size: 0.95rem;
        }
        
        .view-mode-chips-container {
            display: flex;
            gap: 0.5rem;
        }
        
        .view-mode-chip {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            border: 2px solid #E2E8F0;
            background: white;
            color: #475569;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
        }
        
        .view-mode-chip:hover {
            border-color: #DC143C;
            color: #DC143C;
        }
        
        .view-mode-chip.active {
            background: linear-gradient(135deg, #DC143C, #FF4500);
            color: white;
            border-color: #DC143C;
            box-shadow: 0 2px 8px rgba(220, 20, 60, 0.25);
        }
        
        .view-mode-chip:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(220, 20, 60, 0.1);
        }
        
        .current-month-display {
            font-size: clamp(1.1rem, 2.5vw, 1.3rem);
            font-weight: 700;
            color: #DC143C;
            text-align: center;
            margin-bottom: 1rem;
        }
        
        .calendars-container {
            display: grid;
            gap: 1rem;
        }
        
        .calendars-container.single {
            grid-template-columns: 1fr;
        }
        
        .calendars-container.double {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .calendars-container.triple {
            grid-template-columns: repeat(3, 1fr);
        }
        
        .calendar-month-wrapper {
            background: #FFFFFF;
            border-radius: 12px;
            padding: 0.6rem;
            border: 1px solid rgba(220, 20, 60, 0.1);
        }
        
        .calendar-month-title {
            font-size: clamp(1rem, 2vw, 1.2rem);
            color: #DC143C;
            font-weight: 700;
            text-align: center;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
        }
        
        .calendar-month-title-text {
            flex: 1;
            text-align: center;
        }
        
        .calendar-month-nav {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .month-nav-btn {
            background: linear-gradient(135deg, #DC143C 0%, #FF4500 50%, #FFD700 100%);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.25);
            padding: 0;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5rem;
            font-weight: 700;
            line-height: 1;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 
                0 4px 12px rgba(220, 20, 60, 0.35),
                0 2px 4px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
            user-select: none;
        }
        
        .month-nav-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.4s ease, height 0.4s ease;
        }
        
        .month-nav-btn:hover:not(:disabled)::before {
            width: 100%;
            height: 100%;
        }
        
        .month-nav-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #FF4500 0%, #FFD700 50%, #FFA500 100%);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px) scale(1.08);
            box-shadow: 
                0 8px 24px rgba(220, 20, 60, 0.5),
                0 4px 8px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
        }
        
        .month-nav-btn:active:not(:disabled) {
            transform: translateY(0) scale(1.02);
            box-shadow: 
                0 4px 12px rgba(220, 20, 60, 0.4),
                0 2px 4px rgba(0, 0, 0, 0.12),
                inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .month-nav-btn:focus {
            outline: none;
            box-shadow: 
                0 0 0 4px rgba(220, 20, 60, 0.3),
                0 4px 12px rgba(220, 20, 60, 0.35),
                0 2px 4px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }
        
        .month-nav-btn:focus:not(:hover) {
            border-color: rgba(255, 255, 255, 0.4);
        }
        
        .month-nav-btn:disabled {
            background: linear-gradient(135deg, #E2E8F0, #CBD5E1);
            color: #94A3B8;
            border-color: rgba(148, 163, 184, 0.3);
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
            opacity: 0.5;
        }
        
        .month-nav-btn:disabled::before {
            display: none;
        }
        
        .month-nav-btn > * {
            position: relative;
            z-index: 1;
        }
        
        @media (prefers-reduced-motion: reduce) {
            .month-nav-btn {
                transition: background-color 0.2s ease, border-color 0.2s ease, opacity 0.2s ease;
            }
            
            .month-nav-btn:hover:not(:disabled) {
                transform: none;
            }
            
            .month-nav-btn::before {
                display: none;
            }
        }
        
        @media (max-width: 768px) {
            .month-nav-btn {
                width: 42px;
                height: 42px;
                font-size: 1.25rem;
            }
        }
        
        .calendars-container.double .calendar-month-title,
        .calendars-container.triple .calendar-month-title {
            justify-content: center;
        }
        
        .calendars-container.double .calendar-month-nav,
        .calendars-container.triple .calendar-month-nav {
            display: none;
        }
        
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
            border-radius: 16px;
            overflow: visible;
            padding: 0.75rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, rgba(255, 249, 230, 0.3) 0%, rgba(255, 235, 205, 0.2) 100%);
            border: 1px solid rgba(255, 215, 0, 0.15);
        }
        
        .calendar-day-header {
            background: linear-gradient(135deg, #DC143C, #FF4500) !important;
            color: white !important;
            font-weight: 700 !important;
            font-size: 0.875rem;
            padding: 0.875rem 0.5rem !important;
            text-align: center;
            border-radius: 10px;
            border: 2px solid rgba(255, 215, 0, 0.4);
            box-shadow: 
                0 2px 8px rgba(220, 20, 60, 0.25),
                0 0 12px rgba(255, 215, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
            min-height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            letter-spacing: 0.025em;
        }
        
        .calendar-day-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: headerShine 3s ease-in-out infinite;
        }
        
        @keyframes headerShine {
            0% { left: -100%; }
            50% { left: 100%; }
            100% { left: 100%; }
        }
        
        .calendar-day-header:hover {
            background: linear-gradient(135deg, #FF4500, #FFD700) !important;
            transform: translateY(-1px) scale(1.02);
            box-shadow: 
                0 4px 15px rgba(255, 69, 0, 0.5),
                0 0 25px rgba(255, 215, 0, 0.4);
        }
        
        .calendar-day {
            background: #FFFFFF;
            padding: 0.875rem 0.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: 90px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 0.25rem;
            font-weight: 600;
            border-radius: 12px;
            position: relative;
            border: 2px solid rgba(226, 232, 240, 0.6);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        .calendar-day::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255, 248, 220, 0.4) 0%, rgba(255, 235, 205, 0.3) 100%);
            opacity: 0;
            transition: opacity 0.2s ease;
            border-radius: 10px;
            z-index: 0;
        }
        
        .calendar-day > * {
            position: relative;
            z-index: 1;
        }
        
        .calendar-day.traditional-tet {
            min-height: 90px;
        }
        
        .calendar-day:hover {
            background: linear-gradient(135deg, rgba(255, 248, 220, 0.95) 0%, rgba(255, 235, 205, 0.9) 100%);
            transform: translateY(-2px);
            box-shadow: 
                0 4px 12px rgba(255, 215, 0, 0.25),
                0 2px 4px rgba(0, 0, 0, 0.1);
            border-color: rgba(255, 215, 0, 0.5);
        }
        
        .calendar-day:hover::before {
            opacity: 1;
        }
        
        .calendar-day:focus {
            outline: none;
            border-color: #DC143C;
            box-shadow: 
                0 0 0 3px rgba(220, 20, 60, 0.15),
                0 2px 8px rgba(220, 20, 60, 0.2);
        }
        
        .calendar-day.other-month {
            background: #F8FAFC;
            color: #94A3B8;
            opacity: 0.5;
            border-color: rgba(226, 232, 240, 0.4);
        }
        
        .calendar-day.other-month:hover {
            background: #F1F5F9;
            border-color: #CBD5E1;
            opacity: 0.7;
        }
        
        .calendar-day.today {
            background: linear-gradient(135deg, #DC143C 0%, #FF4500 50%, #FFD700 100%);
            background-size: 200% 200%;
            animation: todayGradientShift 4s ease infinite;
            color: white;
            border: 2px solid rgba(255, 215, 0, 0.9);
            box-shadow: 
                0 4px 16px rgba(220, 20, 60, 0.4),
                0 0 24px rgba(255, 215, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            position: relative;
            z-index: 2;
            transform: scale(1.02);
        }
        
        @keyframes todayGradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .calendar-day.today::after {
            content: '';
            position: absolute;
            top: 6px;
            right: 6px;
            width: 8px;
            height: 8px;
            background: rgba(255, 215, 0, 1);
            border-radius: 50%;
            box-shadow: 0 0 8px rgba(255, 215, 0, 0.8);
            animation: todayDotPulse 2s ease-in-out infinite;
        }
        
        @keyframes todayDotPulse {
            0%, 100% { 
                transform: scale(1);
                opacity: 1;
            }
            50% { 
                transform: scale(1.3);
                opacity: 0.7;
            }
        }
        
        .calendar-day.today:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 
                0 6px 20px rgba(220, 20, 60, 0.5),
                0 0 30px rgba(255, 215, 0, 0.4);
        }
        
        .calendar-day.selected {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.95) 0%, rgba(220, 20, 60, 0.85) 100%) !important;
            color: white !important;
            transform: translateY(-2px) scale(1.03);
            border: 2px solid rgba(255, 215, 0, 0.8);
            box-shadow: 
                0 6px 20px rgba(255, 215, 0, 0.4), 
                0 0 24px rgba(220, 20, 60, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }
        
        .calendar-day.selected:hover {
            transform: translateY(-3px) scale(1.03);
            box-shadow: 
                0 8px 24px rgba(255, 215, 0, 0.5), 
                0 0 30px rgba(220, 20, 60, 0.3);
        }
        
        .calendar-day.traditional-tet {
            background: linear-gradient(135deg, rgba(255, 249, 230, 0.95) 0%, rgba(255, 235, 205, 0.95) 100%);
            border-color: rgba(255, 215, 0, 0.3);
            border-width: 2px;
            position: relative;
        }
        
        .calendar-day.traditional-tet.tet-main {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.9) 0%, rgba(255, 165, 0, 0.9) 50%, rgba(255, 99, 71, 0.9) 100%);
            color: white;
            border-color: rgba(220, 20, 60, 0.6);
            border-width: 2px;
            font-weight: 700;
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.5), 0 0 20px rgba(220, 20, 60, 0.3);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }
        
        .calendar-day.traditional-tet.tet-important {
            background: linear-gradient(135deg, rgba(255, 228, 225, 0.95) 0%, rgba(255, 249, 230, 0.95) 100%);
            border-color: rgba(255, 69, 0, 0.4);
            border-width: 2px;
        }
        
        .calendar-day.traditional-tet:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.3);
        }
        
        .calendar-day.traditional-tet:hover::before {
            opacity: 1;
        }
        
        .calendar-day.traditional-tet .tet-label {
            font-size: 0.65rem;
            color: var(--color-event-lunar, #C62828);
            font-weight: 600;
            margin-top: 4px;
            line-height: 1.2;
            text-align: center;
            width: 100%;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            word-break: break-word;
            hyphens: auto;
        }
        
        .calendar-day.traditional-tet.tet-main .tet-label {
            color: white;
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .calendar-day.traditional-tet.tet-important .tet-label {
            color: #FF4500;
        }
        
        .calendar-day .tet-label-holiday {
            font-size: 0.65rem;
            color: var(--color-event-solar, #1565C0);
            font-weight: 600;
            line-height: 1.2;
            margin-top: 0.15rem;
        }
        
        .calendar-day.solar-holiday-only {
            background: linear-gradient(135deg, rgba(21, 101, 192, 0.08) 0%, rgba(46, 139, 87, 0.06) 100%);
            border-color: rgba(21, 101, 192, 0.25);
            border-width: 1px;
        }
        .calendar-day.solar-holiday-only:hover {
            background: linear-gradient(135deg, rgba(21, 101, 192, 0.12) 0%, rgba(46, 139, 87, 0.1) 100%);
        }
        
        .calendar-day .calendar-day-now-note {
            font-size: 0.6rem;
            font-weight: 700;
            color: var(--color-primary);
            margin-top: 0.2rem;
            padding: 0.1rem 0.35rem;
            background: rgba(255, 215, 0, 0.35);
            border-radius: 999px;
            display: inline-block;
        }
        
        .events-upcoming-wrap {
            margin-bottom: 1rem;
            padding: 0.75rem 1rem;
            background: linear-gradient(135deg, #fff9f0 0%, #fff5eb 100%);
            border-radius: 12px;
            border: 1px solid rgba(230, 0, 38, 0.1);
        }
        .events-upcoming-title {
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--color-primary);
            margin: 0 0 0.5rem 0;
        }
        .events-upcoming-legend {
            font-size: 0.7rem;
            margin-bottom: 0.35rem;
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }
        .events-upcoming-legend span { display: inline-flex; align-items: center; gap: 0.25rem; }
        .events-upcoming-legend .dot-lunar { width: 6px; height: 6px; border-radius: 50%; background: var(--color-event-lunar, #C62828); }
        .events-upcoming-legend .dot-solar { width: 6px; height: 6px; border-radius: 50%; background: var(--color-event-solar, #1565C0); }
        .events-upcoming {
            font-size: 0.8rem;
            color: var(--color-text-secondary);
            line-height: 1.5;
        }
        .events-upcoming .event-upcoming-item {
            margin-bottom: 0.25rem;
        }
        .events-upcoming .event-upcoming-item.event-upcoming-item--lunar { color: var(--color-event-lunar, #C62828); font-weight: 500; }
        .events-upcoming .event-upcoming-item.event-upcoming-item--solar { color: var(--color-event-solar, #1565C0); font-weight: 500; }
        .events-upcoming .event-upcoming-item:last-child { margin-bottom: 0; }
        .events-upcoming .event-item-link { display: block; text-decoration: none; padding: 0.2rem 0; border-radius: 6px; transition: background 0.2s; }
        .events-upcoming .event-item-link:hover { background: rgba(230, 0, 38, 0.06); }
        
        .events-full-list-wrap {
            margin-bottom: 1rem;
            padding: 0.75rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #fff 100%);
            border-radius: 12px;
            border: 1px solid rgba(0,0,0,0.06);
        }
        .events-full-list-title {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--color-text-primary);
            margin: 0 0 0.5rem 0;
        }
        .events-full-list {
            font-size: 0.8rem;
            color: var(--color-text-secondary);
            line-height: 1.6;
            max-height: 280px;
            overflow-y: auto;
        }
        .events-full-list .event-full-item {
            margin-bottom: 0.35rem;
            padding: 0.2rem 0;
            border-bottom: 1px solid rgba(0,0,0,0.04);
        }
        .events-full-list .event-full-item:last-child { border-bottom: none; }
        .events-full-list .event-full-item.event-full-item--lunar { color: var(--color-event-lunar, #C62828); font-weight: 500; }
        .events-full-list .event-full-item.event-full-item--solar { color: var(--color-event-solar, #1565C0); font-weight: 500; }
        .events-full-list .event-days-left { font-weight: 600; color: var(--color-primary); margin-right: 0.35rem; }
        
        .events-year-list-wrap {
            margin-bottom: 1rem;
            padding: 0.75rem 1rem;
            background: linear-gradient(135deg, #f0f9ff 0%, #fff 100%);
            border-radius: 12px;
            border: 1px solid rgba(0,0,0,0.06);
        }
        .events-year-list-title {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--color-text-primary);
            margin: 0 0 0.35rem 0;
        }
        .events-year-list-title #eventsYearListYear { color: var(--color-primary); }
        .events-year-list-wrap .events-upcoming-legend { margin-bottom: 0.5rem; }
        .events-year-list {
            font-size: 0.8rem;
            color: var(--color-text-secondary);
            line-height: 1.6;
            max-height: 320px;
            overflow-y: auto;
        }
        .events-year-list .event-year-item {
            margin-bottom: 0.3rem;
            padding: 0.2rem 0;
            border-bottom: 1px solid rgba(0,0,0,0.04);
        }
        .events-year-list .event-year-item:last-child { border-bottom: none; }
        .events-year-list .event-year-item.event-year-item--lunar { color: var(--color-event-lunar, #C62828); font-weight: 500; }
        .events-year-list .event-year-item.event-year-item--solar { color: var(--color-event-solar, #1565C0); font-weight: 500; }
        .events-year-list .event-item-link { display: block; text-decoration: none; padding: 0.2rem 0; border-radius: 6px; transition: background 0.2s; }
        .events-year-list .event-item-link:hover { background: rgba(230, 0, 38, 0.06); }
        .events-year-list .event-days-left { font-weight: 600; color: var(--color-primary); margin-right: 0.35rem; }
        .events-year-list .event-days-past { font-size: 0.75rem; color: var(--color-text-secondary); margin-right: 0.35rem; opacity: 0.85; }
        
        .lunar-info-item.tet-info-item {
            background: linear-gradient(135deg, #FFF9E6, #FFEBCD);
            border-left-color: #FFD700;
        }
        
        .lunar-info-item.tet-info-item h4 {
            color: #DC143C;
        }
        
        .calendar-day .day-number {
            font-size: 1.125rem;
            font-weight: 700;
            color: #1F2937;
            line-height: 1.2;
            margin-bottom: 0.125rem;
        }
        
        .calendar-day .lunar-date {
            font-size: 0.75rem;
            color: #6B7280;
            font-weight: 500;
            line-height: 1.2;
            opacity: 0.85;
        }
        
        .calendar-day.selected .day-number {
            color: rgba(255, 255, 255, 1);
            font-weight: 700;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .calendar-day.selected .lunar-date {
            color: rgba(255, 255, 255, 0.9);
            font-weight: 600;
            opacity: 1;
        }
        
        .calendar-day.today .day-number {
            color: white;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .calendar-day.today .lunar-date {
            color: rgba(255, 255, 255, 0.95);
            opacity: 1;
        }
        
        .calendar-day.other-month .day-number {
            color: #94A3B8;
        }
        
        .calendar-day.other-month .lunar-date {
            color: #CBD5E1;
        }
        
        .detail-section {
            margin-bottom: 1.5rem;
        }
        
        .detail-section:last-child {
            margin-bottom: 0;
        }
        
        .detail-section-title {
            color: #DC143C;
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #E2E8F0;
        }
        
        .detail-section-content {
            color: #475569;
            line-height: 1.6;
        }
        
        .detail-section-content p {
            margin: 0.5rem 0;
        }
        
        .detail-section-content strong {
            color: #0F172A;
            font-weight: 700;
        }
        
        .hour-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.75rem;
            margin-top: 0.75rem;
        }
        
        .hour-item {
            background: #F8FAFC;
            padding: 0.75rem;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #E2E8F0;
        }
        
        .hour-item.auspicious {
            background: linear-gradient(135deg, #D1FAE5, #A7F3D0);
            border-color: #10B981;
            color: #065F46;
        }
        
        .hour-item.inauspicious {
            background: linear-gradient(135deg, #FEE2E2, #FECACA);
            border-color: #EF4444;
            color: #991B1B;
        }
        
        .hour-item .hour-time {
            font-weight: 700;
            font-size: 0.85rem;
            line-height: 1.3;
        }
        
        .dialog-content::-webkit-scrollbar {
            width: 8px;
        }
        
        .dialog-content::-webkit-scrollbar-track {
            background: #F1F5F9;
            border-radius: 4px;
        }
        
        .dialog-content::-webkit-scrollbar-thumb {
            background: #CBD5E1;
            border-radius: 4px;
        }
        
        .dialog-content::-webkit-scrollbar-thumb:hover {
            background: #94A3B8;
        }
        
        .activity-list {
            list-style: none;
            padding: 0;
            margin: 0.75rem 0;
        }
        
        .activity-list li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
        }
        
        .activity-list li::before {
            content: '•';
            position: absolute;
            left: 0;
            color: #DC143C;
            font-weight: 700;
        }
        
        .activity-list li.good::before {
            content: '✓';
            color: #10B981;
            font-weight: 700;
        }
        
        .activity-list li.bad::before {
            content: '✗';
            color: #EF4444;
            font-weight: 700;
        }
        
        .activity-list li {
            color: #475569;
        }
        
        .activity-list li.good {
            color: #065F46;
        }
        
        .activity-list li.bad {
            color: #991B1B;
        }
        
        .holiday-badge {
            display: inline-block;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #0F172A;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9rem;
            margin: 0.5rem 0.5rem 0.5rem 0;
        }
        
        .holiday-badge.traditional {
            background: linear-gradient(135deg, #FFE4E1, #FFF9E6);
            color: var(--color-event-lunar, #C62828);
            border: 2px solid rgba(198, 40, 40, 0.4);
        }
        
        .holiday-badge.holiday {
            background: linear-gradient(135deg, #DBEAFE, #E0E7FF);
            color: var(--color-event-solar, #1565C0);
            border: 2px solid rgba(21, 101, 192, 0.4);
        }
        
        .lunar-info h3::before {
            content: '';
            width: 24px;
            height: 24px;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23DC143C'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z'/%3E%3C/svg%3E") no-repeat center;
            background-size: contain;
        }
        
        .lunar-info-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1rem;
        }
        
        .lunar-info-item {
            background: #F8FAFC;
            padding: 1rem 1.25rem;
            border-radius: 10px;
            border-left: 3px solid #DC143C;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: all 0.2s ease;
        }
        
        .lunar-info-item:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .lunar-info-item h4 {
            color: #DC143C;
            margin-bottom: 0.5rem;
            font-size: 1rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .lunar-info-item h4::before {
            content: '';
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }
        
        .lunar-info-item:nth-child(1) h4::before {
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23DC143C'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z'/%3E%3C/svg%3E") no-repeat center;
            background-size: contain;
        }
        
        .lunar-info-item:nth-child(2) h4::before {
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23DC143C'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z'/%3E%3C/svg%3E") no-repeat center;
            background-size: contain;
        }
        
        .lunar-info-item:nth-child(3) h4::before {
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23DC143C'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z'/%3E%3C/svg%3E") no-repeat center;
            background-size: contain;
        }
        
        .lunar-info-item p {
            color: #475569;
            margin: 0.5rem 0;
            line-height: 1.6;
        }
        
        .lunar-info-item p strong {
            color: #0F172A;
            font-weight: 700;
        }
        
        .empty-state {
            text-align: center;
            color: #64748B;
            padding: 2rem;
            font-size: 1rem;
        }
        
        .calendar-detail-section {
            margin-top: 2rem;
            background: #FFFFFF;
            border-radius: 16px;
            padding: clamp(1rem, 3vw, 1.5rem);
            box-shadow: 0 8px 32px rgba(0,0,0,0.08);
            border: 1px solid rgba(220, 20, 60, 0.1);
            min-height: 200px;
        }
        
        .calendar-detail-section .empty-state {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 200px;
        }
        
        .calendar-detail-section:not(:has(.empty-state)) {
            min-height: auto;
        }
        
        @media (max-width: 1024px) {
            .calendar-wrapper {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .detail-panel {
                position: static;
                max-height: none;
            }
            
            .calendars-container.double,
            .calendars-container.triple {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .calendar-content {
                padding: 1.5rem 0;
            }
            
            .calendar-container {
                padding: 1rem;
            }
            
            .dialog {
                max-width: 100%;
                max-height: 95vh;
                margin: 0.5rem;
                border-radius: 12px;
            }
            
            .dialog-overlay {
                padding: 0.5rem;
            }
            
            .dialog-header {
                padding: 1rem;
            }
            
            .dialog-content {
                padding: 1rem;
                -webkit-overflow-scrolling: touch;
            }
            
            .calendar-title-row {
                flex-direction: column;
                align-items: stretch;
            }
            
            .calendar-nav-buttons {
                width: 100%;
                justify-content: space-between;
            }
            
            .calendar-nav-buttons button {
                flex: 1;
            }
            
            .calendar-month-title {
                flex-direction: row;
                gap: 0.75rem;
            }
            
            .calendar-month-title-text {
                flex: 1;
                order: 0;
            }
            
            .month-nav-btn {
                order: -1;
                width: 44px;
                min-width: 44px;
                height: 44px;
                min-height: 44px;
                font-size: 1.15rem;
            }
            
            .month-nav-btn:last-child {
                order: 1;
            }
            
            .calendar-controls-row {
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
            }
            
            .year-selector,
            .view-mode-chips {
                width: 100%;
                justify-content: space-between;
            }
            
            .view-mode-chips-container {
                flex: 1;
                justify-content: flex-end;
            }
            
            .view-mode-chip {
                flex: 1;
                text-align: center;
                min-height: 44px;
                display: inline-flex;
                align-items: center;
                justify-content: center;
            }
            
            .calendar-grid {
                gap: 0.35rem;
                padding: 0.5rem;
            }
            
            .calendar-day {
                min-height: 72px;
                padding: 0.6rem 0.35rem;
            }
            
            .calendar-day.traditional-tet {
                min-height: 72px;
            }
            
            .calendar-day.traditional-tet .tet-label {
                font-size: 0.55rem;
                line-height: 1.15;
            }
            
            .calendar-day-header {
                padding: 0.6rem 0.25rem;
                font-size: 0.7rem;
                min-height: 36px;
            }
            
            .calendar-day .day-number {
                font-size: 0.9rem;
            }
            
            .calendar-day .lunar-date {
                font-size: 0.6rem;
            }
            
            .hour-list {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .go-to-today-btn {
                min-height: 44px;
            }
            
            .year-selector select {
                min-height: 44px;
            }
        }
        
        @media (max-width: 480px) {
            .calendar-hero {
                padding: 3rem 0.75rem 2rem;
            }
            
            .calendar-hero h1 {
                font-size: 1.75rem;
            }
            
            .calendar-hero .subtitle {
                font-size: 0.95rem;
            }
            
            .calendar-content {
                padding: 1rem 0;
            }
            
            .calendar-container {
                padding: 0.75rem;
            }
            
            .calendar-title {
                font-size: 1.25rem;
                min-width: 0;
            }
            
            .current-month-display {
                font-size: 1rem;
            }
            
            .calendar-controls-row {
                gap: 0.75rem;
            }
            
            .calendar-grid {
                gap: 2px;
                padding: 4px;
            }
            
            .calendar-day-header {
                font-size: 0.6rem;
                padding: 0.5rem 0.15rem !important;
                min-height: 32px;
            }
            
            .calendar-day {
                min-height: 52px;
                padding: 0.4rem 0.2rem;
                border-radius: 8px;
            }
            
            .calendar-day.traditional-tet {
                min-height: 56px;
            }
            
            .calendar-day .day-number {
                font-size: 0.8rem;
            }
            
            .calendar-day .lunar-date {
                font-size: 0.55rem;
            }
            
            .calendar-day.traditional-tet .tet-label {
                font-size: 0.5rem;
                -webkit-line-clamp: 1;
                line-clamp: 1;
            }
            
            .month-nav-btn {
                width: 44px;
                height: 44px;
                font-size: 1.1rem;
            }
            
            .dialog {
                max-height: 90vh;
                margin: 0.25rem;
                border-radius: 12px;
            }
            
            .dialog-header h3 {
                font-size: 1rem;
            }
            
            .dialog-close {
                width: 40px;
                height: 40px;
                min-width: 40px;
                min-height: 40px;
            }
            
            .view-mode-chip {
                padding: 0.5rem 0.6rem;
                font-size: 0.8rem;
            }
            
            @supports (padding: max(0px)) {
                .calendar-hero { padding-left: max(0.75rem, env(safe-area-inset-left)); padding-right: max(0.75rem, env(safe-area-inset-right)); }
                .calendar-container { padding-left: max(0.75rem, env(safe-area-inset-left)); padding-right: max(0.75rem, env(safe-area-inset-right)); }
                .dialog { margin-left: max(0.25rem, env(safe-area-inset-left)); margin-right: max(0.25rem, env(safe-area-inset-right)); }
            }
        }
        
        @media (min-width: 1025px) {
            .calendar-container {
                max-width: 100%;
            }
            
            .calendar-grid {
                gap: 8px;
            }
            
            .calendar-day {
                min-height: 95px;
            }
            
            .calendars-container.double,
            .calendars-container.triple {
                gap: 1.5rem;
            }
        }
        
        @media (max-width: 768px) {
            .calendar-nav {
                flex-direction: column;
            }
            
            .calendar-nav button {
                width: 100%;
            }
            
            .current-month {
                order: -1;
                width: 100%;
                margin-bottom: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header will be loaded dynamically -->
    <div id="header-container"></div>

    <main>
        <section class="calendar-hero">
            <div class="container">
                <h1>Lịch Vạn Niên 2026</h1>
                <p class="subtitle">Xem lịch âm dương đầy đủ, tra cứu ngày tốt xấu, giờ hoàng đạo</p>
            </div>
        </section>

        <section class="calendar-content">
            <div class="container">
                <div class="calendar-wrapper">
                    <div class="calendar-container">
                    <div class="calendar-header">
                        <div class="calendar-title-row">
                            <h2 class="calendar-title">Lịch Vạn Niên - Lịch Âm Dương</h2>
                        </div>
                        
                        <div class="current-month-display" id="currentMonth" role="heading" aria-level="3">Tháng 1, 2026</div>
                        
                        <div class="calendar-controls-row">
                            <div class="year-selector">
                                <label for="year-select">Năm:</label>
                                <select id="year-select" aria-label="Chọn năm">
                                    <option value="2024">2024</option>
                                    <option value="2025">2025</option>
                                    <option value="2026" selected>2026</option>
                                    <option value="2027">2027</option>
                                    <option value="2028">2028</option>
                                </select>
                            </div>
                            
                            <button id="goToTodayBtn" class="go-to-today-btn" aria-label="Về hôm nay">
                                Trở về hôm nay
                            </button>
                            
                            <div class="view-mode-chips">
                                <label>Chế độ:</label>
                                <div class="view-mode-chips-container">
                                    <div class="view-mode-chip active" data-mode="single" role="button" tabindex="0" aria-label="1 tháng">1 tháng</div>
                                    <div class="view-mode-chip" data-mode="double" role="button" tabindex="0" aria-label="2 tháng">2 tháng</div>
                                    <div class="view-mode-chip" data-mode="triple" role="button" tabindex="0" aria-label="3 tháng">3 tháng</div>
                                </div>
                            </div>
                        </div>
                    </div>
                        
                        <div id="eventsUpcomingWrap" class="events-upcoming-wrap" aria-live="polite">
                            <p class="events-upcoming-title">📌 Sự kiện trong 1 tháng tới</p>
                            <div class="events-upcoming-legend"><span><span class="dot-lunar" aria-hidden="true"></span> 🌙 Âm lịch</span><span><span class="dot-solar" aria-hidden="true"></span> ☀️ Dương lịch</span></div>
                            <div id="eventsUpcoming" class="events-upcoming"></div>
                        </div>
                        
                        <div class="calendars-container single" id="calendarsContainer">
                            <!-- Calendar will be generated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Detail Section below calendar -->
                    <div class="calendar-detail-section" id="calendarDetailSection">
                        <div class="empty-state">
                            <p>Chọn một ngày trong lịch để xem thông tin chi tiết</p>
                        </div>
                    </div>
                    
                    <!-- Sự kiện trong năm (dưới calendar detail, click vào từng sự kiện → trang chi tiết) -->
                    <div id="eventsYearListWrap" class="events-year-list-wrap" aria-live="polite">
                        <p class="events-year-list-title">📅 Tất cả sự kiện trong năm <span id="eventsYearListYear"></span></p>
                        <div class="events-upcoming-legend"><span><span class="dot-lunar" aria-hidden="true"></span> 🌙 Âm lịch</span><span><span class="dot-solar" aria-hidden="true"></span> ☀️ Dương lịch</span></div>
                        <div id="eventsYearList" class="events-year-list"></div>
                    </div>
                </div>
                
                <!-- Dialog for detail information -->
                <div class="dialog-overlay" id="detailDialog" role="dialog" aria-labelledby="dialogTitle" aria-modal="true">
                    <div class="dialog">
                        <div class="dialog-header">
                            <h3 id="dialogTitle">Thông tin chi tiết</h3>
                            <button class="dialog-close" aria-label="Đóng" id="dialogClose">×</button>
                        </div>
                        <div class="dialog-content" id="dialogContent">
                            <!-- Content will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Combined Support & Footer Section -->
    <div id="footer-container"></div>

    <!-- Scripts -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="js/header-loader.js"></script>
    <script src="js/icons.js"></script>
    <script src="js/lunar-calendar.js"></script>
    <script src="js/trung-thu-calculator.js"></script>
    <script src="data/events-data.js"></script>
    <script>
        // Tên các tháng
        const monthNames = [
            'Tháng 1', 'Tháng 2', 'Tháng 3', 'Tháng 4', 'Tháng 5', 'Tháng 6',
            'Tháng 7', 'Tháng 8', 'Tháng 9', 'Tháng 10', 'Tháng 11', 'Tháng 12'
        ];
        
        // Tên các ngày trong tuần
        const dayNames = ['CN', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7'];
        
        // Tên các tháng âm lịch
        const lunarMonths = [
            'Giêng', 'Hai', 'Ba', 'Tư', 'Năm', 'Sáu',
            'Bảy', 'Tám', 'Chín', 'Mười', 'Mười một', 'Chạp'
        ];
        
        let currentDate = new Date(2026, 0, 1); // Initialize to January 2026
        let selectedDate = null;
        
        // Tính toán các ngày Tết / sự kiện âm lịch từ EVENTS_DATA (đầy đủ, chính xác)
        // Tháng Chạp (12): 23/12 (Ông Táo) rơi vào năm dương trước Tết → tính cả year-1 để hiện đúng trên lịch
        function getTraditionalTetDates(year) {
            const dates = {};
            if (typeof EVENTS_DATA !== 'undefined' && EVENTS_DATA.LUNAR_EVENTS && typeof lunarToSolar === 'function') {
                function addEvent(ev, solarDate) {
                    if (!solarDate) return;
                    const key = formatDateKey(solarDate);
                    dates[key] = {
                        name: ev.name,
                        lunar: ev.lunarLabel,
                        description: ev.description,
                        type: 'traditional',
                        importance: ev.type === 'major' ? 'high' : 'medium',
                        isMain: ev.isMainTet || false
                    };
                }
                EVENTS_DATA.LUNAR_EVENTS.forEach(function (ev) {
                    let solarDate;
                    if (ev.lunarMonth === 8 && ev.lunarDay === 15 && typeof calculateTrungThuDate === 'function') {
                        solarDate = calculateTrungThuDate(year);
                    } else {
                        solarDate = lunarToSolar(year, ev.lunarMonth, ev.lunarDay);
                    }
                    addEvent(ev, solarDate);
                    // Tháng Chạp (23/12 Ông Táo...): ngày đó thuộc năm âm trước Tết, rơi vào tháng 1–2 dương lịch → thêm year-1
                    if (ev.lunarMonth === 12) {
                        const solarPrev = lunarToSolar(year - 1, 12, ev.lunarDay);
                        if (solarPrev && solarPrev.getFullYear() === year) addEvent(ev, solarPrev);
                    }
                });
                return dates;
            }
            // Fallback khi chưa load events-data: chỉ dùng Tết chính
            let tetDate = (typeof TET_DATES !== 'undefined' && TET_DATES[year]) ? new Date(TET_DATES[year]) : (calculateTetDate ? calculateTetDate(year) : new Date(year, 1, 17));
            dates[formatDateKey(tetDate)] = { name: 'Tết Nguyên Đán', lunar: 'Mùng 1 tháng Giêng', description: 'Ngày Tết cổ truyền lớn nhất năm.', type: 'traditional', importance: 'highest', isMain: true };
            return dates;
        }
        
        function formatDateKey(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }
        
        function generateSingleCalendar(container, year, month, showTitle = true) {
            const calendarGrid = document.createElement('div');
            calendarGrid.className = 'calendar-grid';
            calendarGrid.setAttribute('role', 'grid');
            calendarGrid.setAttribute('aria-label', `Lịch ${monthNames[month]} ${year}`);
            
            // Thêm header các ngày trong tuần
            dayNames.forEach((day) => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'calendar-day-header';
                dayHeader.textContent = day;
                dayHeader.setAttribute('role', 'columnheader');
                dayHeader.setAttribute('aria-label', day);
                calendarGrid.appendChild(dayHeader);
            });
            
            // Lấy ngày đầu tiên của tháng và số ngày trong tháng
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDayOfWeek = firstDay.getDay();
            
            // Thêm ngày của tháng trước
            const prevMonth = new Date(year, month - 1, 0);
            for (let i = startingDayOfWeek - 1; i >= 0; i--) {
                const day = prevMonth.getDate() - i;
                const dayElement = createDayElement(day, true, year, month - 1);
                calendarGrid.appendChild(dayElement);
            }
            
            // Thêm ngày của tháng hiện tại
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = createDayElement(day, false, year, month);
                calendarGrid.appendChild(dayElement);
            }
            
            // Thêm ngày của tháng sau để lấp đầy lưới
            const remainingDays = 42 - (startingDayOfWeek + daysInMonth);
            for (let day = 1; day <= remainingDays; day++) {
                const dayElement = createDayElement(day, true, year, month + 1);
                calendarGrid.appendChild(dayElement);
            }
            
            container.appendChild(calendarGrid);
            return calendarGrid;
        }
        
        function generateCalendar() {
            const calendarsContainer = document.getElementById('calendarsContainer');
            const currentMonthElement = document.getElementById('currentMonth');
            const activeChip = document.querySelector('.view-mode-chip.active');
            const viewMode = activeChip ? activeChip.getAttribute('data-mode') : 'single';
            const year = currentDate.getFullYear();
            
            // Reset detail section when calendar regenerates
            const detailSection = document.getElementById('calendarDetailSection');
            if (detailSection) {
                detailSection.innerHTML = '<div class="empty-state"><p>Chọn một ngày trong lịch để xem thông tin chi tiết</p></div>';
            }
            
            // Remove selected class from all days
            document.querySelectorAll('.calendar-day').forEach(d => {
                d.classList.remove('selected');
                d.setAttribute('aria-selected', 'false');
            });
            const month = currentDate.getMonth();
            
            // Cập nhật tiêu đề tháng chính
            if (currentMonthElement) {
                currentMonthElement.textContent = `${monthNames[month]}, ${year}`;
            }
            
            // Clear container
            if (!calendarsContainer) {
                console.error('calendarsContainer not found');
                return;
            }
            
            calendarsContainer.innerHTML = '';
            calendarsContainer.className = `calendars-container ${viewMode}`;
            
            let monthsToShow = 1;
            if (viewMode === 'double') monthsToShow = 2;
            else if (viewMode === 'triple') monthsToShow = 3;
            
            for (let i = 0; i < monthsToShow; i++) {
                const monthWrapper = document.createElement('div');
                monthWrapper.className = 'calendar-month-wrapper';
                
                const monthTitle = document.createElement('div');
                monthTitle.className = 'calendar-month-title';
                
                // Calculate display month and year
                const displayMonthIndex = month + i;
                const displayMonth = displayMonthIndex % 12;
                const displayYear = displayMonthIndex >= 12 ? year + 1 : year;
                
                // Only show nav buttons in single mode
                if (viewMode === 'single' && i === 0) {
                    const prevBtn = document.createElement('button');
                    prevBtn.textContent = '←';
                    prevBtn.setAttribute('aria-label', 'Tháng trước');
                    prevBtn.className = 'month-nav-btn';
                    prevBtn.addEventListener('click', () => {
                        currentDate.setMonth(currentDate.getMonth() - 1);
                        generateCalendar();
                    });
                    monthTitle.appendChild(prevBtn);
                    
                    const titleText = document.createElement('div');
                    titleText.className = 'calendar-month-title-text';
                    titleText.textContent = `${monthNames[displayMonth]}, ${displayYear}`;
                    monthTitle.appendChild(titleText);
                    
                    const nextBtn = document.createElement('button');
                    nextBtn.textContent = '→';
                    nextBtn.setAttribute('aria-label', 'Tháng sau');
                    nextBtn.className = 'month-nav-btn';
                    nextBtn.addEventListener('click', () => {
                        currentDate.setMonth(currentDate.getMonth() + 1);
                        generateCalendar();
                    });
                    monthTitle.appendChild(nextBtn);
                } else {
                    const titleText = document.createElement('div');
                    titleText.className = 'calendar-month-title-text';
                    titleText.textContent = `${monthNames[displayMonth]}, ${displayYear}`;
                    monthTitle.appendChild(titleText);
                }
                
                monthWrapper.appendChild(monthTitle);
                
                generateSingleCalendar(monthWrapper, displayYear, displayMonth);
                calendarsContainer.appendChild(monthWrapper);
            }
        }
        
        function createDayElement(day, isOtherMonth, year, month) {
            const dayElement = document.createElement('div');
            dayElement.className = 'calendar-day';
            dayElement.setAttribute('role', 'gridcell');
            dayElement.setAttribute('tabindex', '0');
            
            if (isOtherMonth) {
                dayElement.classList.add('other-month');
            }
            
            // Kiểm tra ngày hôm nay
            const today = new Date();
            const isToday = !isOtherMonth && 
                           day === today.getDate() && 
                           month === today.getMonth() && 
                           year === today.getFullYear();
            
            if (isToday) {
                dayElement.classList.add('today');
                dayElement.setAttribute('aria-label', `Hôm nay, ngày ${day}`);
            }
            
            // Tính toán ngày âm lịch
            const solarDate = new Date(year, month, day);
            let lunarInfo;
            
            try {
                if (typeof calculateLunarDate === 'function') {
                    lunarInfo = calculateLunarDate(solarDate);
                } else {
                    lunarInfo = { day: 1, month: 1 };
                }
            } catch (e) {
                lunarInfo = { day: 1, month: 1 };
            }
            
            const lunarMonth = lunarMonths[lunarInfo.month - 1] || lunarMonths[0];
            const lunarDateStr = lunarInfo.day === 1 
                ? `Mùng 1 tháng ${lunarMonth}` 
                : `${lunarInfo.day} tháng ${lunarMonth}`;
            
            // Kiểm tra ngày Tết truyền thống và ngày lễ dương lịch
            const dateKey = formatDateKey(solarDate);
            const traditionalDates = getTraditionalTetDates(year);
            const traditionalDate = traditionalDates[dateKey];
            const holidayInfo = getHolidayInfo(solarDate);
            
            if (traditionalDate) {
                dayElement.classList.add('traditional-tet');
                if (traditionalDate.isMain) {
                    dayElement.classList.add('tet-main');
                } else if (traditionalDate.importance === 'high' || traditionalDate.importance === 'highest') {
                    dayElement.classList.add('tet-important');
                }
                
                dayElement.setAttribute('aria-label', `Ngày ${day} tháng ${month + 1} năm ${year}, ${lunarDateStr}, ${traditionalDate.name}`);
                dayElement.setAttribute('data-tet-info', JSON.stringify(traditionalDate));
            } else {
                dayElement.setAttribute('aria-label', `Ngày ${day} tháng ${month + 1} năm ${year}, ${lunarDateStr}`);
            }
            
            // Nội dung ngày
            const dayNumber = document.createElement('div');
            dayNumber.className = 'day-number';
            dayNumber.textContent = day;
            dayElement.appendChild(dayNumber);
            
            // Hiển thị lunar date: ngày 1 hiển thị "1/X", các ngày khác chỉ hiển thị số ngày
            const lunarDate = document.createElement('div');
            lunarDate.className = 'lunar-date';
            
            if (lunarInfo.day === 1) {
                lunarDate.textContent = `1/${lunarInfo.month}`;
            } else {
                lunarDate.textContent = `${lunarInfo.day}`;
            }
            
            dayElement.appendChild(lunarDate);
            
            // Thêm label cho ngày Tết truyền thống (sau lunarDate)
            if (traditionalDate) {
                const tetLabel = document.createElement('div');
                tetLabel.className = 'tet-label';
                tetLabel.textContent = traditionalDate.name;
                dayElement.appendChild(tetLabel);
            }
            
            // Thêm label cho ngày lễ dương lịch (khi không trùng ngày âm đã có label)
            if (holidayInfo && !traditionalDate) {
                dayElement.classList.add('solar-holiday-only');
                const holidayLabel = document.createElement('div');
                holidayLabel.className = 'tet-label tet-label-holiday';
                holidayLabel.textContent = holidayInfo.name;
                dayElement.appendChild(holidayLabel);
            }
            
            // Note "Đang diễn ra" khi hôm nay là ngày có sự kiện
            if (isToday && (traditionalDate || holidayInfo)) {
                const nowNote = document.createElement('div');
                nowNote.className = 'calendar-day-now-note';
                nowNote.textContent = 'Đang diễn ra';
                dayElement.appendChild(nowNote);
            }
            
            // Thêm sự kiện click và keyboard
            const selectDay = () => {
                selectedDate = solarDate;
                updateLunarInfo(solarDate);
                
                // Remove selected class from all days
                document.querySelectorAll('.calendar-day').forEach(d => {
                    d.classList.remove('selected');
                    d.setAttribute('aria-selected', 'false');
                });
                
                // Add selected class to clicked day
                dayElement.classList.add('selected');
                dayElement.setAttribute('aria-selected', 'true');
                dayElement.focus();
                
                // Open dialog
                openDialog();
            };
            
            dayElement.addEventListener('click', selectDay);
            dayElement.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    selectDay();
                }
            });
            
            return dayElement;
        }
        
        // Tính toán giờ hoàng đạo và hắc đạo
        function calculateAuspiciousHours(date) {
            const dayOfWeek = date.getDay();
            
            // Giờ hoàng đạo và hắc đạo theo ngày trong tuần
            const auspiciousHours = {
                0: ['23:00-01:00', '05:00-07:00', '11:00-13:00'], // Chủ nhật
                1: ['01:00-03:00', '07:00-09:00', '13:00-15:00'], // Thứ hai
                2: ['03:00-05:00', '09:00-11:00', '15:00-17:00'], // Thứ ba
                3: ['05:00-07:00', '11:00-13:00', '17:00-19:00'], // Thứ tư
                4: ['07:00-09:00', '13:00-15:00', '19:00-21:00'], // Thứ năm
                5: ['09:00-11:00', '15:00-17:00', '21:00-23:00'], // Thứ sáu
                6: ['11:00-13:00', '17:00-19:00', '23:00-01:00']  // Thứ bảy
            };
            
            const inauspiciousHours = {
                0: ['09:00-11:00', '15:00-17:00', '21:00-23:00'],
                1: ['11:00-13:00', '17:00-19:00', '23:00-01:00'],
                2: ['13:00-15:00', '19:00-21:00', '01:00-03:00'],
                3: ['15:00-17:00', '21:00-23:00', '03:00-05:00'],
                4: ['17:00-19:00', '23:00-01:00', '05:00-07:00'],
                5: ['19:00-21:00', '01:00-03:00', '07:00-09:00'],
                6: ['21:00-23:00', '03:00-05:00', '09:00-11:00']
            };
            
            return {
                auspicious: auspiciousHours[dayOfWeek] || [],
                inauspicious: inauspiciousHours[dayOfWeek] || []
            };
        }
        
        // Lấy việc nên làm và không nên làm
        function getGoodActivities(lunarDay) {
            const activities = {
                1: ['Khai trương', 'Khởi công', 'Cưới hỏi', 'Xuất hành'],
                2: ['Xuất hành', 'Giao dịch', 'Mua sắm', 'Ký hợp đồng'],
                3: ['Cầu nguyện', 'Thờ cúng', 'Học tập', 'Thi cử'],
                4: ['An táng', 'Dọn nhà', 'Sửa chữa', 'Trang trí'],
                5: ['Khai trương', 'Ký hợp đồng', 'Đầu tư', 'Khởi nghiệp'],
                6: ['Cưới hỏi', 'Xuất hành', 'Gặp gỡ', 'Sum họp'],
                7: ['Thờ cúng', 'Cầu nguyện', 'Tu tập', 'Tĩnh tâm'],
                8: ['Khởi công', 'Xây dựng', 'Trồng trọt', 'Gieo hạt'],
                9: ['Giao dịch', 'Mua bán', 'Kinh doanh', 'Đàm phán'],
                10: ['Cưới hỏi', 'Lễ hội', 'Vui chơi', 'Tổ chức tiệc'],
                11: ['Xuất hành', 'Du lịch', 'Di chuyển', 'Khám phá'],
                12: ['Học tập', 'Nghiên cứu', 'Sáng tác', 'Viết lách'],
                13: ['Khai trương', 'Khởi nghiệp', 'Đầu tư', 'Mở rộng'],
                14: ['Cầu nguyện', 'Thờ cúng', 'Từ thiện', 'Giúp đỡ'],
                15: ['Cưới hỏi', 'Lễ hội', 'Sum họp', 'Tổ chức sự kiện'],
                16: ['Xuất hành', 'Giao dịch', 'Hợp tác', 'Ký kết'],
                17: ['Sửa chữa', 'Tu bổ', 'Cải tạo', 'Nâng cấp'],
                18: ['Học tập', 'Thi cử', 'Nghiên cứu', 'Phát triển'],
                19: ['Khai trương', 'Kinh doanh', 'Đầu tư', 'Mở cửa'],
                20: ['Cưới hỏi', 'Lễ hội', 'Vui chơi', 'Giải trí'],
                21: ['Xuất hành', 'Du lịch', 'Khám phá', 'Tham quan'],
                22: ['Thờ cúng', 'Cầu nguyện', 'Tu tập', 'Thiền định'],
                23: ['Giao dịch', 'Mua bán', 'Hợp tác', 'Đàm phán'],
                24: ['Sửa chữa', 'Dọn dẹp', 'Trang trí', 'Tổ chức'],
                25: ['Cưới hỏi', 'Sum họp', 'Gặp gỡ', 'Hội họp'],
                26: ['Học tập', 'Nghiên cứu', 'Sáng tác', 'Phát triển'],
                27: ['Khai trương', 'Khởi công', 'Đầu tư', 'Mở rộng'],
                28: ['Xuất hành', 'Giao dịch', 'Kinh doanh', 'Hợp tác'],
                29: ['Cầu nguyện', 'Thờ cúng', 'Từ thiện', 'Giúp đỡ'],
                30: ['Nghỉ ngơi', 'Tĩnh tâm', 'Suy ngẫm', 'Thư giãn']
            };
            return activities[lunarDay] || ['Các việc thông thường'];
        }
        
        function getBadActivities(lunarDay) {
            const activities = {
                1: ['An táng', 'Phá dỡ', 'Tranh cãi', 'Kiện tụng'],
                2: ['Khởi công', 'Xây dựng', 'Động thổ', 'Đào đất'],
                3: ['Cưới hỏi', 'Khai trương', 'Xuất hành', 'Giao dịch'],
                4: ['Cầu nguyện', 'Thờ cúng', 'Học tập', 'Thi cử'],
                5: ['An táng', 'Chôn cất', 'Tranh cãi', 'Kiện tụng'],
                6: ['Sửa chữa', 'Phá dỡ', 'Động thổ', 'Xây dựng'],
                7: ['Cưới hỏi', 'Khai trương', 'Xuất hành', 'Giao dịch'],
                8: ['Cầu nguyện', 'Thờ cúng', 'Học tập', 'Thi cử'],
                9: ['An táng', 'Chôn cất', 'Tranh cãi', 'Kiện tụng'],
                10: ['Sửa chữa', 'Phá dỡ', 'Động thổ', 'Xây dựng']
            };
            return activities[lunarDay] || ['Các việc không phù hợp'];
        }
        
        // Kiểm tra ngày nghỉ lễ / sự kiện dương lịch (đầy đủ từ EVENTS_DATA)
        function getHolidayInfo(date) {
            const dateKey = formatDateKey(date);
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            const fixedHolidays = {};
            if (typeof EVENTS_DATA !== 'undefined') {
                [EVENTS_DATA.SOLAR_EVENTS_VIETNAM, EVENTS_DATA.SOLAR_EVENTS_INTERNATIONAL].forEach(function (list) {
                    if (!list) return;
                    list.forEach(function (ev) {
                        const key = year + '-' + String(ev.month).padStart(2, '0') + '-' + String(ev.day).padStart(2, '0');
                        if (!fixedHolidays[key]) fixedHolidays[key] = { name: ev.name, type: ev.type || 'national', description: ev.description };
                    });
                });
            }
            if (fixedHolidays[dateKey]) return fixedHolidays[dateKey];
            // Giỗ Tổ Hùng Vương - 10/3 âm lịch (trùng ngày âm)
            let lunarInfo;
            try {
                if (typeof calculateLunarDate === 'function') lunarInfo = calculateLunarDate(date);
            } catch (e) {}
            if (lunarInfo && lunarInfo.month === 3 && lunarInfo.day === 10) {
                return { name: 'Giỗ Tổ Hùng Vương', type: 'national', description: 'Quốc lễ – nghỉ lễ chính thức. Ngày giỗ các Vua Hùng, tưởng nhớ công ơn dựng nước.' };
            }
            return null;
        }
        
        // Dialog functions
        function openDialog() {
            const dialog = document.getElementById('detailDialog');
            dialog.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeDialog() {
            const dialog = document.getElementById('detailDialog');
            dialog.classList.remove('active');
            document.body.style.overflow = '';
        }
        
        function updateLunarInfo(date) {
            const dialogContent = document.getElementById('dialogContent');
            const dialogTitle = document.getElementById('dialogTitle');
            const detailSection = document.getElementById('calendarDetailSection');
            
            // Calculate lunar date
            let lunarInfo;
            try {
                if (typeof calculateLunarDate === 'function') {
                    lunarInfo = calculateLunarDate(date);
                } else {
                    lunarInfo = { day: 1, month: 1 };
                }
            } catch (e) {
                lunarInfo = { day: 1, month: 1 };
            }
            
            const lunarMonth = lunarMonths[lunarInfo.month - 1] || lunarMonths[0];
            const dayNames = ['Chủ nhật', 'Thứ hai', 'Thứ ba', 'Thứ tư', 'Thứ năm', 'Thứ sáu', 'Thứ bảy'];
            const dayName = dayNames[date.getDay()];
            
            const solarDateStr = `${date.getDate()}/${date.getMonth() + 1}/${date.getFullYear()}`;
            const lunarDateStr = lunarInfo.day === 1 
                ? `Mùng 1 tháng ${lunarMonth}` 
                : `${lunarInfo.day} tháng ${lunarMonth}`;
            
            // Tính toán giờ hoàng đạo
            const hoursData = calculateAuspiciousHours(date);
            
            // Kiểm tra ngày Tết truyền thống
            const dateKey = formatDateKey(date);
            const traditionalDates = getTraditionalTetDates(date.getFullYear());
            const traditionalDate = traditionalDates[dateKey];
            
            // Kiểm tra ngày nghỉ lễ
            const holidayInfo = getHolidayInfo(date);
            
            // Lấy việc nên làm và không nên làm
            const goodActivities = getGoodActivities(lunarInfo.day);
            const badActivities = getBadActivities(lunarInfo.day);
            
            // Update dialog title
            dialogTitle.textContent = `${dayName}, ${solarDateStr}`;
            
            // Tạo HTML cho dialog content
            let badgesHTML = '';
            if (traditionalDate) {
                badgesHTML += `<span class="holiday-badge traditional">${traditionalDate.name}</span>`;
            }
            if (holidayInfo) {
                badgesHTML += `<span class="holiday-badge holiday">${holidayInfo.name}</span>`;
            }
            if (date.getDay() === 0 || date.getDay() === 6) {
                badgesHTML += `<span class="holiday-badge">Cuối tuần</span>`;
            }
            
            // Tạo HTML content (dùng chung cho cả dialog và detail section)
            const detailHTML = `
                <div class="detail-section">
                    <div class="detail-section-title">
                        <span>📅 Thông tin ngày</span>
                    </div>
                    <div class="detail-section-content">
                        <p><strong>Dương lịch:</strong> ${dayName}, ${solarDateStr}</p>
                        <p><strong>Âm lịch:</strong> ${lunarDateStr}</p>
                        <p><strong>Năm:</strong> ${date.getFullYear()} - Tháng ${lunarMonth} âm lịch</p>
                        ${badgesHTML ? `<div style="margin-top: 1rem;">${badgesHTML}</div>` : ''}
                    </div>
                </div>
                
                ${traditionalDate ? `
                <div class="detail-section">
                    <div class="detail-section-title">
                        <span>🎊 Ngày Tết truyền thống</span>
                    </div>
                    <div class="detail-section-content">
                        <p><strong>${traditionalDate.name}</strong></p>
                        <p>${traditionalDate.description}</p>
                        <p style="color: #64748B; font-size: 0.9rem;">${traditionalDate.lunar} âm lịch</p>
                    </div>
                </div>
                ` : ''}
                
                ${holidayInfo ? `
                <div class="detail-section">
                    <div class="detail-section-title">
                        <span>🇻🇳 Ngày nghỉ lễ</span>
                    </div>
                    <div class="detail-section-content">
                        <p><strong>${holidayInfo.name}</strong></p>
                        <p>${holidayInfo.description || 'Ngày nghỉ lễ quốc gia Việt Nam'}</p>
                        <p style="color: #64748B; font-size: 0.9rem; margin-top: 0.5rem;">Đây là ngày nghỉ lễ chính thức</p>
                    </div>
                </div>
                ` : ''}
                
                ${!traditionalDate && (lunarInfo.day === 1 || lunarInfo.day === 15) ? `
                <div class="detail-section">
                    <div class="detail-section-title">
                        <span>🕯️ Ngày âm lịch (tâm linh)</span>
                    </div>
                    <div class="detail-section-content">
                        <p>${lunarInfo.day === 1 ? 'Mùng 1' : 'Rằm (15)'} âm lịch – ngày cúng, tâm linh phổ biến hàng tháng. Nhiều gia đình cúng ông bà tổ tiên vào mùng 1 và rằm.</p>
                    </div>
                </div>
                ` : ''}
                
                <div class="detail-section">
                    <div class="detail-section-title">
                        <span>⏰ Giờ hoàng đạo</span>
                    </div>
                    <div class="detail-section-content">
                        <p style="margin-bottom: 0.75rem;"><strong>Giờ tốt để làm việc quan trọng:</strong></p>
                        <div class="hour-list">
                            ${hoursData.auspicious.map(hour => `
                                <div class="hour-item auspicious">
                                    <div class="hour-time">${hour}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
                
                <div class="detail-section">
                    <div class="detail-section-title">
                        <span>⚠️ Giờ hắc đạo</span>
                    </div>
                    <div class="detail-section-content">
                        <p style="margin-bottom: 0.75rem;"><strong>Nên tránh làm việc quan trọng:</strong></p>
                        <div class="hour-list">
                            ${hoursData.inauspicious.map(hour => `
                                <div class="hour-item inauspicious">
                                    <div class="hour-time">${hour}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
                
                <div class="detail-section">
                    <div class="detail-section-title">
                        <span>✅ Việc nên làm</span>
                    </div>
                    <div class="detail-section-content">
                        <ul class="activity-list">
                            ${goodActivities.map(activity => `<li class="good">${activity}</li>`).join('')}
                        </ul>
                    </div>
                </div>
                
                <div class="detail-section">
                    <div class="detail-section-title">
                        <span>❌ Việc không nên làm</span>
                    </div>
                    <div class="detail-section-content">
                        <ul class="activity-list">
                            ${badActivities.map(activity => `<li class="bad">${activity}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `;
            
            // Update dialog content
            dialogContent.innerHTML = detailHTML;
            
            // Update detail section below calendar
            if (detailSection) {
                detailSection.innerHTML = detailHTML;
            }
        }
        
        const ONE_MONTH_MS = 30 * 24 * 60 * 60 * 1000;

        function pad2(n) { return (n < 10 ? '0' : '') + n; }
        function formatDate(d) { return pad2(d.getDate()) + '/' + pad2(d.getMonth() + 1) + '/' + d.getFullYear(); }
        function formatDateParam(d) { return d.getFullYear() + '-' + pad2(d.getMonth() + 1) + '-' + pad2(d.getDate()); }
        function daysFromToday(d) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const t = new Date(d.getFullYear(), d.getMonth(), d.getDate());
            t.setHours(0, 0, 0, 0);
            return Math.round((t - today) / (24 * 60 * 60 * 1000));
        }

        /** Thu thập tất cả sự kiện (âm + dương) từ hôm nay trở đi, năm nay và năm sau, rồi sort từ gần đến xa. */
        function collectAllUpcomingEvents() {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const year = today.getFullYear();
            const items = [];
            if (typeof EVENTS_DATA === 'undefined') return items;
            if (typeof lunarToSolar === 'function' && EVENTS_DATA.LUNAR_EVENTS) {
                EVENTS_DATA.LUNAR_EVENTS.forEach(function (ev) {
                    let d = lunarToSolar(year, ev.lunarMonth, ev.lunarDay);
                    if (d) { d = new Date(d.getFullYear(), d.getMonth(), d.getDate()); d.setHours(0, 0, 0, 0); if (d >= today) items.push({ date: d, name: ev.name, lunar: ev.lunarLabel }); }
                    d = lunarToSolar(year + 1, ev.lunarMonth, ev.lunarDay);
                    if (d) { d = new Date(d.getFullYear(), d.getMonth(), d.getDate()); d.setHours(0, 0, 0, 0); if (d >= today) items.push({ date: d, name: ev.name, lunar: ev.lunarLabel }); }
                    if (ev.lunarMonth === 12) {
                        d = lunarToSolar(year - 1, 12, ev.lunarDay);
                        if (d) { d = new Date(d.getFullYear(), d.getMonth(), d.getDate()); d.setHours(0, 0, 0, 0); if (d >= today) items.push({ date: d, name: ev.name, lunar: ev.lunarLabel }); }
                    }
                });
            }
            [EVENTS_DATA.SOLAR_EVENTS_VIETNAM, EVENTS_DATA.SOLAR_EVENTS_INTERNATIONAL].forEach(function (list) {
                if (!list) return;
                list.forEach(function (ev) {
                    let d = new Date(year, ev.month - 1, ev.day);
                    d.setHours(0, 0, 0, 0);
                    if (d >= today) items.push({ date: d, name: ev.name, lunar: null });
                    d = new Date(year + 1, ev.month - 1, ev.day);
                    d.setHours(0, 0, 0, 0);
                    if (d >= today) items.push({ date: d, name: ev.name, lunar: null });
                });
            });
            items.sort(function (a, b) { return a.date - b.date; });
            return items;
        }

        /** Thu thập tất cả sự kiện (âm + dương) trong một năm dương lịch, sort theo ngày. */
        function collectAllEventsInYear(year) {
            const items = [];
            if (typeof EVENTS_DATA === 'undefined') return items;
            const yearStart = new Date(year, 0, 1);
            yearStart.setHours(0, 0, 0, 0);
            const yearEnd = new Date(year, 11, 31);
            yearEnd.setHours(23, 59, 59, 999);
            if (typeof lunarToSolar === 'function' && EVENTS_DATA.LUNAR_EVENTS) {
                EVENTS_DATA.LUNAR_EVENTS.forEach(function (ev) {
                    let d = lunarToSolar(year, ev.lunarMonth, ev.lunarDay);
                    if (d) {
                        d = new Date(d.getFullYear(), d.getMonth(), d.getDate());
                        d.setHours(0, 0, 0, 0);
                        if (d >= yearStart && d <= yearEnd) items.push({ date: d, name: ev.name, lunar: ev.lunarLabel });
                    }
                    if (ev.lunarMonth === 12) {
                        d = lunarToSolar(year - 1, 12, ev.lunarDay);
                        if (d) {
                            d = new Date(d.getFullYear(), d.getMonth(), d.getDate());
                            d.setHours(0, 0, 0, 0);
                            if (d >= yearStart && d <= yearEnd) items.push({ date: d, name: ev.name, lunar: ev.lunarLabel });
                        }
                    }
                });
            }
            [EVENTS_DATA.SOLAR_EVENTS_VIETNAM, EVENTS_DATA.SOLAR_EVENTS_INTERNATIONAL].forEach(function (list) {
                if (!list) return;
                list.forEach(function (ev) {
                    const d = new Date(year, ev.month - 1, ev.day);
                    d.setHours(0, 0, 0, 0);
                    items.push({ date: d, name: ev.name, lunar: null });
                });
            });
            items.sort(function (a, b) { return a.date - b.date; });
            return items;
        }

        function updateEventsUpcoming() {
            const wrap = document.getElementById('eventsUpcomingWrap');
            const el = document.getElementById('eventsUpcoming');
            if (!el || !wrap) return;
            if (typeof EVENTS_DATA === 'undefined') { wrap.style.display = 'none'; return; }
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const todayTime = today.getTime();
            const endOneMonth = todayTime + ONE_MONTH_MS;
            const all = collectAllUpcomingEvents();
            const inOneMonth = all.filter(function (x) { return x.date.getTime() >= todayTime && x.date.getTime() <= endOneMonth; });
            if (inOneMonth.length === 0) {
                wrap.style.display = 'none';
            } else {
                wrap.style.display = '';
                el.innerHTML = inOneMonth.map(function (x) {
                    const days = daysFromToday(x.date);
                    const dStr = formatDate(x.date);
                    const dateParam = formatDateParam(x.date);
                    const typeClass = x.lunar ? 'event-upcoming-item--lunar' : 'event-upcoming-item--solar';
                    const daysText = days === 0 ? 'Hôm nay' : 'Còn ' + days + ' ngày';
                    return '<a href="chi-tiet-su-kien.html?date=' + encodeURIComponent(formatDateParam(x.date)) + '" class="event-upcoming-item ' + typeClass + ' event-item-link"><span class="event-days-left">' + daysText + '</span> – ' + x.name + ' (' + dStr + ')' + (x.lunar ? ' – ' + x.lunar + ' âm lịch' : '') + '</a>';
                }).join('');
            }
        }

        function updateEventsInYearList(year) {
            const wrap = document.getElementById('eventsYearListWrap');
            const el = document.getElementById('eventsYearList');
            const yearEl = document.getElementById('eventsYearListYear');
            if (!wrap || !el) return;
            if (typeof EVENTS_DATA === 'undefined') { wrap.style.display = 'none'; return; }
            if (yearEl) yearEl.textContent = year;
            const items = collectAllEventsInYear(year);
            if (items.length === 0) {
                wrap.style.display = 'none';
                return;
            }
            wrap.style.display = '';
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            el.innerHTML = items.map(function (x) {
                const dStr = formatDate(x.date);
                const typeClass = x.lunar ? 'event-year-item--lunar' : 'event-year-item--solar';
                const days = daysFromToday(x.date);
                let prefix = '';
                if (x.date.getTime() === today.getTime()) prefix = '<span class="event-days-left">Hôm nay</span> – ';
                else if (days > 0) prefix = '<span class="event-days-left">Còn ' + days + ' ngày</span> – ';
                else prefix = '<span class="event-days-past">Đã qua</span> – ';
                const url = 'chi-tiet-su-kien.html?date=' + encodeURIComponent(formatDateParam(x.date));
                return '<a href="' + url + '" class="event-year-item ' + typeClass + ' event-item-link">' + prefix + x.name + ' (' + dStr + ')' + (x.lunar ? ' – ' + x.lunar + ' âm lịch' : '') + '</a>';
            }).join('');
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', () => {
            generateCalendar();
            updateEventsUpcoming();
            const yearSelect = document.getElementById('year-select');
            const year = yearSelect ? parseInt(yearSelect.value, 10) : new Date().getFullYear();
            updateEventsInYearList(year);
            
            // Dialog event listeners
            const dialogCloseBtn = document.getElementById('dialogClose');
            const dialogOverlay = document.getElementById('detailDialog');
            
            if (dialogCloseBtn) {
                dialogCloseBtn.addEventListener('click', closeDialog);
            }
            
            if (dialogOverlay) {
                dialogOverlay.addEventListener('click', (e) => {
                    if (e.target === dialogOverlay) {
                        closeDialog();
                    }
                });
            }
            
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && dialogOverlay && dialogOverlay.classList.contains('active')) {
                    closeDialog();
                }
            });
            
            // Event listeners for header buttons (only visible in double/triple mode)
            const prevMonthBtn = document.getElementById('prevMonth');
            const nextMonthBtn = document.getElementById('nextMonth');
            
            if (prevMonthBtn) {
                prevMonthBtn.addEventListener('click', () => {
                    currentDate.setMonth(currentDate.getMonth() - 1);
                    generateCalendar();
                });
            }
            
            if (nextMonthBtn) {
                nextMonthBtn.addEventListener('click', () => {
                    currentDate.setMonth(currentDate.getMonth() + 1);
                    generateCalendar();
                });
            }
            
            // Nút "Về hôm nay"
            const goToTodayBtn = document.getElementById('goToTodayBtn');
            if (goToTodayBtn) {
                goToTodayBtn.addEventListener('click', () => {
                    const today = new Date();
                    currentDate = new Date(today);
                    
                    // Cập nhật year selector
                    const yearSelect = document.getElementById('year-select');
                    if (yearSelect) {
                        yearSelect.value = today.getFullYear();
                    }
                    
                    // Regenerate calendar
                    generateCalendar();
                    updateEventsInYearList(today.getFullYear());
                    
                    // Scroll đến ngày hôm nay sau một chút delay để calendar render xong
                    setTimeout(() => {
                        const todayElement = document.querySelector('.calendar-day.today');
                        if (todayElement) {
                            todayElement.scrollIntoView({ 
                                behavior: 'smooth', 
                                block: 'center',
                                inline: 'center'
                            });
                            
                            // Highlight ngày hôm nay
                            todayElement.style.animation = 'none';
                            setTimeout(() => {
                                todayElement.style.animation = '';
                            }, 10);
                        }
                    }, 100);
                });
            }
            
            document.getElementById('year-select').addEventListener('change', (e) => {
                const year = parseInt(e.target.value, 10);
                currentDate.setFullYear(year);
                generateCalendar();
                updateEventsInYearList(year);
            });
            
            // View mode chips event listeners
            const viewModeChips = document.querySelectorAll('.view-mode-chip');
            viewModeChips.forEach(chip => {
                chip.addEventListener('click', () => {
                    const mode = chip.getAttribute('data-mode');
                    viewModeChips.forEach(c => c.classList.remove('active'));
                    chip.classList.add('active');
                    
                    const calendarsContainer = document.getElementById('calendarsContainer');
                    calendarsContainer.className = `calendars-container ${mode}`;
                    generateCalendar();
                });
                
                chip.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        chip.click();
                    }
                });
            });
        });
    </script>
    <script src="js/footer.js"></script>
</body>
</html>
